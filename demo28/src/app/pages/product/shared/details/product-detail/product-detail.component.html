<div class="product-details">
  <h1 class="product-title">{{ product.productName }}</h1>

  <div class="ratings-container">
    <div class="ratings">
      <div class="ratings-val" [style.width]="product.avgRating * 20 + '%'"></div>
      <span class="tooltip-text">{{ product.avgRating.toFixed(2) }}</span>
    </div>
    <span class="ratings-text">( {{ product.totalRating }} Reviews )</span>
    <span class="ratings-text">( {{ product.totalSold }} Sold )</span>

  </div>

  <div class="product-price">
    <ng-container *ngIf="hasOnlyOnePrice; else elseBlock">
      <ng-container *ngIf="product.productSale === null; else discountBlock">
        {{ product.maxPrice | currency: 'USD'}}
      </ng-container>
      <ng-template #discountBlock>
        <span style="text-decoration: line-through; font-weight: bold; color: grey">
          {{ product.maxPrice | currency: 'USD' }}
        </span>
        <span>
          {{ " - "}}
        </span>
        <span style="font-weight: bold">
          {{
            (product.productSale.productSaleType.typeName == 'Fixed' ?
              product.minPrice - product.productSale.discount :
              product.minPrice * (1 - product.productSale.discount/100)) | currency: 'USD'
          }}
        </span>
      </ng-template>
    </ng-container>
    <ng-template #elseBlock>
      <ng-container *ngIf="product.productSale === null; else discountBlock2">
        <span style="font-weight: bold">
          {{product.minPrice | currency: 'USD'}}&ndash;{{product.maxPrice | currency: 'USD'}}
        </span>
      </ng-container>
      <ng-template #discountBlock2>
        <span style="text-decoration: line-through; font-weight: bold; color: grey">
          {{product.minPrice | currency: 'USD'}}&ndash;{{product.maxPrice | currency: 'USD'}}
        </span>
        <div class=""></div>
        <span style="font-weight: bold">
          {{
            (product.productSale.productSaleType.typeName == 'Fixed' ?
              (product.minPrice - product.productSale.discount < 0 ? 0 : product.minPrice - product.productSale.discount)  :
              product.minPrice * (1 - product.productSale.discount/100)) | currency: 'USD'
          }}
        </span>
        <span>
          {{ " - "}}
        </span>
        <span style="font-weight: bold">
          {{
            (product.productSale.productSaleType.typeName == 'Fixed' ?
              (product.maxPrice - product.productSale.discount < 0 ? 0 : product.maxPrice - product.productSale.discount)  :
              product.maxPrice * (1 - product.productSale.discount/100)) | currency: 'USD'
          }}
        </span>
      </ng-template>
    </ng-template>
  </div>

  <div class="product-content">
    <p [innerHTML]="product.description"></p>
  </div>

  <div *ngIf="product.productVariants.length > 0">
    <div class="details-filter-row details-row-size">
      <label for="size">Size:</label>
      <div class="select-custom">
        <select name="size" id="size" class="form-control" [(ngModel)]="selectedVariant"
          (ngModelChange)="selectVariant($event)">
          <option value="">Select a size</option>
          <option [ngValue]="variant" *ngFor="let variant of product.productVariants">
            {{ variant.productSize.sizeName }}
          </option>
        </select>
      </div>
    </div>
  </div>

  <div class="details-filter-row details-row-size">
    <label for="qty">Qty:</label>
    <molla-quantity-input (changeQty)="onChangeQty( $event )" [value]="qty">
    </molla-quantity-input>
  </div>

  <div class="product-details-action">
    <a href="javascript:;" class="btn-product btn-cart" (click)="addCart( $event )"><span>add to cart</span></a>



    <div class="details-action-wrapper">
      <a href="javascript:;" class="btn-product btn-wishlist" [class.added-to-wishlist]="isInWishlist()"
        (click)="addToWishlist($event)">
        <span>{{ isInWishlist() ? 'Go' : 'Add' }} to Wishlist</span>
      </a>
    </div>
  </div>

  <div class="product-details-footer">
    <div class="product-cat w-100 text-truncate">
      <span>Catalog:</span>
      <span>
        <a [routerLink]="['/shop/sidebar/list']" [queryParams]="{catalog: product.catalog.catalogName}">{{
          product.catalog.catalogName
          }}</a></span>
    </div>
    <div class="product-cat w-100 text-truncate">
      <span>Level of Difficulty in Growing Plants:</span>
      <span>
        <a [routerLink]="['/shop/sidebar/list']" [queryParams]="{level: product.plantingDifficultyLevel.level}">
          {{product.plantingDifficultyLevel.level}}
        </a>
      </span>
    </div>

    <div class="social-icons social-icons-sm">
      <span class="social-label">Share:</span>
      <a href="javascript:;" class="social-icon" title="Facebook"><i class="icon-facebook-f"></i></a>
      <a href="javascript:;" class="social-icon" title="Twitter"><i class="icon-twitter"></i></a>
      <a href="javascript:;" class="social-icon" title="Instagram"><i class="icon-instagram"></i></a>
      <a href="javascript:;" class="social-icon" title="Pinterest"><i class="icon-pinterest"></i></a>
    </div>
  </div>
</div>
